//minified using http://www.minifyjavascript.com/
var otherPrefix="[Other] - ";function SubmitReasons(e){e.preventDefault();var obj=JSON.parse(localStorage.getItem("questions"));var q_array=obj.Questions;var errorText="Please answer all the required questions highlighted";var hasError=false;var ctl;var firstErrCtl;if(q_array.length<3){hasError=ValidateReasons1(q_array)}else{hasError=ValidateReasons2(q_array)}if(hasError){showNativeDialog(errorText);return}var myJsonObj=SetUpIntakeJSONObj();if(q_array.length<3){for(var i=0;i<q_array.length;i++){var question=q_array[i];var inputtype="checkbox";if(question.ResponsesType=="1"||question.ResponsesType=="2"){$('input[name="input-'+question.ID+'"]:checked').each(function(){myJsonObj.Reasons.ReasonsList.push({"ReasonID":$(this).attr('id'),"ReasonDetails":$("#"+$(this).attr('id')+"-txtother").val()})})}else if(question.ResponsesType=="3"){var select=$("#ul_"+question.ID+" li[data-role=combobox]");myJsonObj.Reasons.ReasonsList.push({"ReasonID":select.attr('value'),"ReasonDetails":""})}else if(question.ResponsesType=="4"){inputtype="textbox";var txt=$('#'+question.Responses[0].ID);myJsonObj.Reasons.ReasonsList.push({"ReasonID":question.Responses[0].ID,"ReasonDetails":txt.val()})}}}else{var collectedResponses=JSON.parse(localStorage.getItem("CollectedResponses"));var reasonId,otherReason,reasonIdArr,otherReasonId,otherReasonForCheckbox;for(var idx=0;idx<collectedResponses.length;idx++){reasonId=collectedResponses[idx].ReasonId;otherReason=collectedResponses[idx].ReasonDetails;otherReasonId=collectedResponses[idx].OtherReasonId;otherReason=otherReason.replace(otherPrefix,"");if(otherReason==undefined){otherReason=""}if(reasonId.indexOf(",")!=-1){reasonIdArr=reasonId.split(",");for(var idx1=0;idx1<reasonIdArr.length;idx1++){otherReasonForCheckbox="";if(otherReasonId!=undefined&&otherReasonId==reasonIdArr[idx1]){otherReasonForCheckbox=otherReason}myJsonObj.Reasons.ReasonsList.push({"ReasonID":reasonIdArr[idx1],"ReasonDetails":otherReasonForCheckbox})}}else{myJsonObj.Reasons.ReasonsList.push({"ReasonID":reasonId,"ReasonDetails":otherReason})}}}SubmitIntake(myJsonObj)}function ValidateReasons1(q_array){var question,hasError=false;var firstErrCtl;for(var i=0;i<q_array.length;i++){question=q_array[i];if(question.ResponsesType=="1"||question.ResponsesType=="2"){ctl=$('input[name="input-'+question.ID+'"]');if($('input[name="input-'+question.ID+'"]:checked').val()!="on"){$(ctl).closest('div').addClass("Error");hasError=true}else{$(ctl).closest('div').removeClass("Error")}}else if(question.ResponsesType=="4"){ctl=$('#'+question.Responses[0].ID);if($(ctl).val().length==0){$(ctl).addClass("Error");hasError=true}else{$(ctl).removeClass("Error")}}else if(question.ResponseType="3"){var select=$("#ul_"+question.ID+" li[data-role=combobox]");if($(select).attr('value')==-1){$("#ul_"+question.ID+" input").addClass('Error')}else{$("#ul_"+question.ID+" input").removeClass('Error')}}if(firstErrCtl==undefined){firstErrCtl=ctl;$(firstErrCtl).focus()}}return hasError}function ValidateReasons2(q_array){var question,questionId,responseContainer,response,hasError=false;for(var i=0;i<q_array.length;i++){question=q_array[i];responseContainer=$('#divResponse'+question.ID);if(responseContainer.children().length==1){var txtBox=responseContainer.find('input');response=txtBox.val();if($.trim(response)==""){responseContainer.find('input').addClass("Error");SetUserResponseForQuestionId(question.ID,txtBox.attr('id'),"");hasError=true}else{responseContainer.find('input').removeClass("Error");SetUserResponseForQuestionId(question.ID,txtBox.attr('id'),responseContainer.find('input').val())}}else if($('#divResponse'+question.ID).children().length==2){response=$('#divResponse'+question.ID).find('span.Response').text();response=response.replace("Required","");if(response==""){responseContainer.addClass("Error");hasError=true}else{responseContainer.removeClass("Error")}}}return hasError}function SetUserResponseForQuestionId(questionId,reasonId,value){var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));for(var idx=0;idx<collResponses.length;idx++){if(collResponses[idx].QuestionId==questionId){collResponses[idx].ReasonId=reasonId;collResponses[idx].ReasonDetails=value}}localStorage.setItem("CollectedResponses",JSON.stringify(collResponses))}function SubmitNoReasons(){var myJsonObj=SetUpIntakeJSONObj();SubmitIntake(myJsonObj)}function SetUpIntakeJSONObj(){var myJsonObj={UID:localStorage.getItem("uid"),FirstName:localStorage.getItem("firstname"),LastName:localStorage.getItem("lastname"),Phone:localStorage.getItem("phone"),Email:localStorage.getItem("email"),AppID:localStorage.getItem("key"),InitialIntakeStatus:localStorage.getItem("initialintakestatus"),Reasons:{IntakeID:0,ReasonsList:[]},LocationID:localStorage.getItem("selLocationID"),CardSwiped:localStorage.getItem("cardswiped")};return myJsonObj}function SubmitIntake(myJsonObj){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"http://sait-test.uclanet.ucla.edu/sawebnew2/api/submitstudentinfo",dataType:"json",data:JSON.stringify(myJsonObj),beforeSend:function(){loading()},success:function(data){localStorage.setItem("CollectedResponses",JSON.stringify(""));window.open("thankyou.html","_self")},error:function(jqXHR,textStatus,errorThrown){showNativeDialog("An error has occurred. Please try again."+jqXHR.responseText)},complete:function(){endLoading()}})}var app1,paramQuestionId,eventQuestions,otherPrefix="[Other] - ";function Initialize(){app1=new kendo.mobile.Application(document.body);$("#DeptName").text(localStorage.getItem("deptname"));$('.textbox-true').click(function(){$(this).parent().parent().append("<div><input type='text' id='"+$(this).attr('id')+"-txtother' class='temp'/></div>")})};var defaultPageSize=20;function mobileListViewIncremental(){var allOrgs;var fromIdx=0,toIdx=0;var selectedResponse=$('#spanListViewResponse').text();userListViewResponseId=GetUserResponse(paramQuestionId,"Id");if(allOrgs==undefined){var allOrgsFormatted=[];var liText="",responseText;var dataSource=getOrganizations();for(var idx=0;idx<dataSource.length;idx++){responseText=dataSource[idx].Text;liText="<li><label class='km-listview-label'>"+dataSource[idx].Text+"<input type='radio' name='input-"+paramQuestionId+"' id='"+dataSource[idx].ID+"' class='textbox-"+dataSource[idx].OpensTextbox+" km-widget km-icon km-check'/></label></li>";allOrgsFormatted.push({"li":liText,"Text":dataSource[idx].Text})}localStorage.setItem("allOrgs",JSON.stringify(allOrgsFormatted))}var totalLi=dataSource.length;var liCount=$('input[name="input-'+paramQuestionId+'"]').length;if(liCount>0&&liCount<totalLi){}else if(liCount==0){fromIdx=0;toIdx=defaultPageSize;for(var idx=fromIdx;idx<toIdx;idx++){$("#local-filterable-listview1").append(allOrgsFormatted[idx].li)}if(toIdx<totalLi&&$('#liLoadMore').attr('id')==undefined){$("#local-filterable-listview1").append("<li id='liLoadMore' data-click='LoadMoreOrgs' class='LoadMore'><a data-role='button' data-click='LoadMoreOrgs' data-click='LoadMoreOrgs'>Load more...</a></li>")}$("#local-filterable-listview1").kendoMobileListView();$('#liLoadMore').bind('click',LoadMoreOrgs);$('#liLoadMore a').removeClass("km-listview-link");$('#liLoadMore a').kendoMobileButton({click:LoadMoreOrgs});$('input[name="input-'+paramQuestionId+'"]').click(function(){$('#spanListViewResponse').text($(this).parent().text());listViewResponseId=$(this).attr('id')})}var spanIdInScrollContainer=$('div.km-scroll-container #spanQuestionText1').attr('id');if(spanIdInScrollContainer!=undefined){$('#spanQuestionText1').parent().next().next().after($('#divScrollableListView'))}if(selectedResponse!=undefined&&selectedResponse!=""){RestoreUserSelection(selectedResponse)}}function LoadMoreOrgs(e){AddOrgs("")}var searchStartIdx=0,searchEndIdx=0,prevSearchText="",searchResults;function AddOrgs(searchText){var allOrgs=JSON.parse(localStorage.getItem("allOrgs"));var fromIdx,toIdx,liCount,org;var totalLi=allOrgs.length;var selectedResponse=$('#spanListViewResponse').text();userListViewResponseId=GetUserResponse(paramQuestionId,"Id");$('#liLoadMore').remove();if(searchText!=""&&searchText!=undefined){searchText=searchText.toLowerCase();if(prevSearchText!=searchText){searchResults=GetSearchResults(searchText);$("#local-filterable-listview1").empty();prevSearchText=searchText}liCount=$('input[name="input-'+paramQuestionId+'"]').length;fromIdx=liCount+1;toIdx=liCount+defaultPageSize+1;for(var idx=fromIdx;idx<toIdx;idx++){if(searchResults[idx]!=undefined){$("#local-filterable-listview1").append(searchResults[idx].li)}}if(toIdx<searchResults.length&&$('#liLoadMore').attr('id')==undefined){$("#local-filterable-listview1").append("<li id='liLoadMore' data-click='SearchOrg' class='LoadMore'><a data-role='button' data-click='SearchOrg' onclick='SearchOrg' class='AdjustLoadMoreMargin'>Load more search results...</a></li>");$('#liLoadMore a').kendoMobileButton({click:SearchOrg})}$('input[name="input-'+paramQuestionId+'"]').click(function(){$('#spanListViewResponse').text($(this).parent().text());listViewResponseId=$(this).attr('id')})}else{if(prevSearchText!=""){$("#local-filterable-listview1").empty();prevSearchText=""}liCount=$('input[name="input-'+paramQuestionId+'"]').length;fromIdx=liCount+1;toIdx=liCount+defaultPageSize+1;for(var idx=fromIdx;idx<toIdx;idx++){if(allOrgs[idx]!=undefined){$("#local-filterable-listview1").append(allOrgs[idx].li)}}if(toIdx<totalLi&&$('#liLoadMore').attr('id')==undefined){$("#local-filterable-listview1").append("<li id='liLoadMore' data-click='LoadMoreOrgs' class='LoadMore'><a data-role='button' data-click='LoadMoreOrgs' onclick='LoadMoreOrgs'>Load more...</a></li>");$('#liLoadMore a').kendoMobileButton({click:LoadMoreOrgs})}$('input[name="input-'+paramQuestionId+'"]').click(function(){$('#spanListViewResponse').text($(this).parent().text());listViewResponseId=$(this).attr('id')})}if(selectedResponse!=undefined&&selectedResponse!=""){RestoreUserSelection(selectedResponse)}}function RestoreUserSelection(userResponseText){$('input[name="input-'+paramQuestionId+'"]').each(function(){if($(this).parent().text()==userResponseText){$(this).prop('checked',true)}})}function GetSearchResults(searchText){var retResults=[],org;var allOrgs=JSON.parse(localStorage.getItem("allOrgs"));for(var idx=0;idx<allOrgs.length;idx++){org=allOrgs[idx].Text.toLowerCase();if(org.indexOf(searchText)!=-1){retResults.push(allOrgs[idx])}}return retResults}function SearchOrg(e){var ctl=$('#txtSearchOrg');AddOrgs($(ctl).val())}function ClearSearch(){var ctl=$('#txtSearchOrg');ctl.val('');AddOrgs("")}function DisplayResponses(e){eventQuestions=JSON.parse(localStorage.getItem("questions"));var q_array=eventQuestions.Questions;if(q_array.length<3){for(var i=0;i<q_array.length;i++){var question=q_array[i];$('#questions-body div[data-role="content"]').append('<div class="control reasons-form" id="div_reason_list_'+question.ID+'"><label id="i-4" style="margin-bottom:3%;"><span id="'+question.ID+'_prompt"></span></label></div><div class="control">');$("#ulResponses").append("<li><span class='span-question-text'>"+question.QuestionText+"</span><div><ul id='ul_"+question.ID+"'></ul></div></li>");var inputtype=GetResponseControlType(question.ResponsesType);var responses=question.Responses;e.view.content.append($('<ul ></ul>'));var viewID=e.view.id;if(inputtype=="radio"||inputtype=="checkbox"){e.view.element.find("#ul_"+question.ID).kendoMobileListView({template:"<label>#: Text# <input type='"+inputtype+"' name='input-"+question.ID+"' id='#:ID#' class='textbox-#:OpensTextbox#'/></label>",});e.view.element.find("#ul_"+question.ID).data("kendoMobileListView").append(responses)}else if(inputtype=="select"){var defaultEntry=JSON.parse('{"ID":-1,"Text":"","Description":"Select","OpensTextbox":false}');responses.unshift(defaultEntry);$("#ul_"+question.ID).append("<li></li>");e.view.element.find("#ul_"+question.ID+" > li").kendoComboBox({dataTextField:"Text",dataValueField:"ID",dataSource:responses,filter:"contains",suggest:true,index:0});$('#ul_8 input').attr('placeholder','Please select/start typing an organization...')}else if(inputtype=="textbox"){var txtId=responses[0].ID;$("#ul_"+question.ID).append('<input type="text" value="" name="'+question.ID+'" id="'+txtId+'" class="TextBox" />')}else if(inputtype=="numerictextbox"){var txtId=responses[0].ID;$("#ul_"+question.ID).append('<input type="number" value="" name="'+question.ID+'" id="'+txtId+'" class="TextBox Borderless" />')}}$("#ulResponses").append('<li><a data-role="button" id="continueBtn" class="button">Continue</a></li>');e.view.element.find("#continueBtn").kendoMobileButton({click:SubmitReasons})}else{BuildQuestionsAndResponses(q_array,e)}}function BuildQuestionsAndResponses(q_array,e){var canConstructQuestions=$("#divQuestions").children().length==0;if(canConstructQuestions){var collectedResponses=[],response,responseId;for(var i=0;i<q_array.length;i++){var question=q_array[i];var responses=question.Responses;collectedResponses.push({QuestionId:question.ID,ReasonId:"",ReasonDetails:"",OtherReasonId:""});var divContainer='<div id="div'+question.ID+'" class="QuestionAndResponseContainer">{0}</div>';var divQuestionText='<div class="span8"> <span class="QuestionText"><br/>'+question.QuestionText+'</span> </div>';var divResponse='<div class="span4" id="divResponse'+question.ID+'"><ul id="ul_'+question.ID+'"></ul></div>';var responseText="Required";if(responseText==undefined){responseText=""}divResponse='<div class="span4 ResponseContainer" id="divResponse'+question.ID+'" displayListView="false"><span id="spanResponseText'+question.ID+'" class="Response Required">'+responseText+'</span> <a data-role="button"  id="btnResponseDetail_'+question.ID+'" data-questionid="'+question.ID+'" class="ResponseDetailButton"><span><i class="icon-chevron-sign-right"></i></span></a></div>';var divQuestionAndResponse="";var inputtype="checkbox";if(question.ResponsesType=="1"){inputtype="radio";divResponse='<div class="span4 ResponseContainer" id="divResponse'+question.ID+'" displayListView="false"><span id="spanResponseText'+question.ID+'" class="Response Required">'+responseText+'</span> <a data-role="button"  id="btnResponseDetail_'+question.ID+'" data-questionid="'+question.ID+'" class="ResponseDetailButton"><span><i class="icon-chevron-sign-right"></i></span></a></div>'}else if(question.ResponsesType=="2"){inputtype="checkbox";divResponse='<div class="span4 ResponseContainer" id="divResponse'+question.ID+'" displayListView="false"><span id="spanResponseText'+question.ID+'" class="Response Required">'+responseText+'</span> <a data-role="button"  id="btnResponseDetail_'+question.ID+'" data-questionid="'+question.ID+'" class="ResponseDetailButton"><span><i class="icon-chevron-sign-right"></i></span></a></div>'}else if(question.ResponsesType=="3"){inputtype="selectbox";divResponse='<div class="span4 ResponseContainer" id="divResponse'+question.ID+'" displayListView="true"><span id="spanResponseText'+question.ID+'" class="Response Required">'+responseText+'</span> <a data-role="button"  id="btnResponseDetail_'+question.ID+'" data-questionid="'+question.ID+'" class="ResponseDetailButton"><span><i class="icon-chevron-sign-right"></i></span></a></div>'}else if(question.ResponsesType=="4"){inputtype="textbox";responseId=responses[0].ID;divResponse='<div class="span4" id="divResponse'+question.ID+'" style="padding-top:1.5%;"><input type="text" name="'+question.ID+'" id="'+responseId+'"  class="TextBox FloatRight Borderless" placeholder="Required"></input></div>'}else if(question.ResponsesType=="5"){inputtype="textbox";responseId=responses[0].ID;divResponse='<div class="span4" id="divResponse'+question.ID+'" style="padding-top:1.5%;"><input type="number" name="'+question.ID+'" id="'+responseId+'" min="1" max="9999" oninput="MaxLengthCheck(this)" class="TextBox FloatRight Borderless" placeholder="Required"></input></div>'}divQuestionAndResponse=divQuestionText+divResponse;$('#divQuestions').append(divContainer.replace('{0}',divQuestionAndResponse));if(question.ResponsesType!="4"&&question.ResponsesType!="5"){$('#divResponse'+question.ID).click(ShowResponsePage)}if(question.ResponsesType=="5"){$('#'+responseId).bind('keypress',PopulateNumbers);$('#'+responseId).bind("paste",function(e){e.preventDefault()})}var responses=question.Responses;e.view.content.append($('<ul ></ul>'));var viewID=e.view.id;if(inputtype=="radio"||inputtype=="checkbox"||inputtype=="selectbox"){e.view.element.find("#btnResponseDetail_"+question.ID).kendoMobileButton();$("#btnResponseDetail_"+question.ID).addClass('ResponseDetailButton')}else if(inputtype=="textbox"){e.view.element.find("#ul_"+question.ID).kendoMobileListView()}}localStorage.setItem("CollectedResponses",JSON.stringify(collectedResponses));$("#divQuestions").append('<div id="divContinueButton" class="ContinueButtonPadding"><a data-role="button" id="continueBtn" class="button">Continue</a></div>');e.view.element.find("#continueBtn").kendoMobileButton({click:SubmitReasons})}else{var question,responseType,responseText;for(var i=0;i<q_array.length;i++){question=q_array[i];responseType=GetResponseControlType(question.ResponsesType);if(responseType!="textbox"&&responseType!="checkbox"){responseText=GetResponseText(question.ID);if(responseText!=""){$('#divResponse'+question.ID).removeClass("Error");$('#spanResponseText'+question.ID).text(responseText).removeClass("Required")}else{$('#spanResponseText'+question.ID).text("Required").addClass("Required")}}else if(responseType=="checkbox"){var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));if(collResponses!=undefined){responseId=GetUserResponse(question.ID,"Id")}var responseCount=0;if(responseId!=""){responseCount=responseId.split(",").length}if(responseCount>0){$('#spanResponseText'+question.ID).text(responseCount+" selected").removeClass("Required");$('#divResponse'+question.ID).removeClass("Error")}else{$('#spanResponseText'+question.ID).text("Required").addClass("Required")}}else if(responseType=="textbox"){responseText=$('#txt_'+question.ID).val();if(responseText!=""){$('#txt_'+question.ID).removeClass("Error")}}}}}function MaxLengthCheck(ctl){if(ctl.value.length>4){ctl.value=ctl.value.slice(0,4)}}function PopulateNumbers(e){var code=e.keyCode||e.which;if(code<48||code>57){e.preventDefault()}}function GetResponseText(questionId){var allQuestions,responseId,question,responses,retResponseText;responseText="";var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));if(eventQuestions==undefined){eventQuestions=JSON.parse(localStorage.getItem("questions"))}allQuestions=eventQuestions.Questions;if(collResponses!=undefined){responseId=GetUserResponse(questionId,"Id")}for(var idx=0;idx<allQuestions.length;idx++){question=allQuestions[idx];if(question.ID==questionId){responses=question.Responses;for(var idx1=0;idx1<responses.length;idx1++){if(responses[idx1].ID==responseId){retResponseText=responses[idx1].Text;if(responses[idx1].OpensTextbox==true){retResponseText=GetUserResponse(questionId,"OtherText")}break}}}}if(retResponseText==undefined)retResponseText="";return retResponseText}function GetUserResponseId(collResponses,questionId){var retResponseId;for(var idx=0;idx<collResponses.length;idx++){if(collResponses[idx].QuestionId==questionId){retResponseId=collResponses[idx].ReasonId;break}}return retResponseId}function ShowResponsePage(e){var params="",canDisplayListView=false;if(e.button==0){paramQuestionId=$(this).attr('id');paramQuestionId=paramQuestionId.replace("divResponse","");canDisplayListView=$(this).attr('displayListView')}else{params=e.button.data();paramQuestionId=params.questionid}if(canDisplayListView=="true"){app1.navigate("#LocalListView")}else{app1.navigate("#divCompleteResponseView")}}function DisplayQuestionResponses(e){$('#divCompleteResponseView').addClass('DisplayNone');window.setTimeout(function(){$('#divCompleteResponseView').removeClass('DisplayNone')},300);var responseForQuestion,allQuestions,question,questionText,responseControlTypeId,responseControlType;if(eventQuestions==undefined){eventQuestions=JSON.parse(localStorage.getItem("questions"))}allQuestions=eventQuestions.Questions;for(var idx=0;idx<allQuestions.length;idx++){question=allQuestions[idx];if(question.ID==paramQuestionId){responseForQuestion=question.Responses;responseControlTypeId=question.ResponsesType;questionText=question.QuestionText;break}}$('#divCompleteResponseView div.km-listview-wrapper').remove();$('ul[id*="_"]').remove();$('div.OtherDiv').remove();$('#spanQuestionText').text(questionText);e.view.content.append('<ul id="ul_'+paramQuestionId+'"></ul>')responseControlType=GetResponseControlType(responseControlTypeId);var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));var responseId,responseIdColl,responseText,canDisplayListView=false;switch(responseControlType){case"radio":case"checkbox":responseIdColl=GetUserResponse(paramQuestionId,"Id");responseText=GetUserResponse(paramQuestionId,"OtherText");responseText=responseText.replace(otherPrefix,"");var liText="";var canCreateOtherTextBox=false;var responseIdArr=responseIdColl.split(",");var doesQuestionHaveResponse=false;for(var idx=0;idx<responseForQuestion.length;idx++){doesQuestionHaveResponse=CanCheckResponseId(responseForQuestion[idx].ID,responseIdArr);if(doesQuestionHaveResponse){liText="<li><label> "+responseForQuestion[idx].Text+"<input type='"+responseControlType+"' name='input-"+paramQuestionId+"' id='"+responseForQuestion[idx].ID+"' checked='checked' class='textbox-"+responseForQuestion[idx].OpensTextbox+"'/></label></li>"}else{liText="<li><label> "+responseForQuestion[idx].Text+"<input type='"+responseControlType+"' name='input-"+paramQuestionId+"' id='"+responseForQuestion[idx].ID+"' class='textbox-"+responseForQuestion[idx].OpensTextbox+"'/></label></li>"}if(!canCreateOtherTextBox){canCreateOtherTextBox=responseForQuestion[idx].OpensTextbox==true}$("#ul_"+paramQuestionId).append(liText);if(canCreateOtherTextBox&&doesQuestionHaveResponse){$("#ul_"+paramQuestionId).after("<div class='OtherDiv'><input type='text' id='"+responseForQuestion[idx].ID+"-txtother'/></div>");$('div.OtherDiv input').val(responseText)}}e.view.element.find("#ul_"+paramQuestionId).kendoMobileListView();break;case"select":if(false){var defaultEntry=JSON.parse('{"ID":-1,"Text":"","Description":"Select","OpensTextbox":false}');responseForQuestion.unshift(defaultEntry);$("#ul_"+question.ID).append("<li></li>");e.view.element.find("#ul_"+paramQuestionId+" > li").kendoComboBox({dataTextField:"Text",dataValueField:"ID",dataSource:responseForQuestion,filter:"contains",suggest:true,index:0});$('#ul_'+paramQuestionId+' input').attr('placeholder','Please select/start typing an organization...');var combo=$("#ul_"+paramQuestionId+" li[data-role=combobox]").data("kendoComboBox");responseIdColl=GetUserResponse(paramQuestionId,"Id");combo.value(responseIdColl)}else{canDisplayListView=true}break}if($('.textbox-true').attr("type")=="radio"){$('.textbox-true').click(function(){if($('div.OtherDiv input').attr('id')==undefined){$(this).closest('ul').after("<div class='OtherDiv'><input type='text' id='"+$(this).attr('id')+"-txtother'/></div>")$('div.OtherDiv input').focus()}});$('.textbox-false').click(function(){$('div.OtherDiv').remove()})}else if($('.textbox-true').attr("type")=="checkbox"){$('.textbox-true').click(function(){if($('div.OtherDiv input').attr('id')==undefined){if($('.textbox-true').is(":checked")){$(this).closest('ul').after("<div class='OtherDiv'><input type='text' id='"+$(this).attr('id')+"-txtother'/></div>")$('div.OtherDiv input').focus()}}else{$('div.OtherDiv').remove()}})}if(canDisplayListView){app1.navigate("#LocalListView")}}function GetUserResponse(paramQuestionId,prop){var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));var retPropValue="";if(collResponses.length>0){for(var idx=0;idx<collResponses.length;idx++){if(paramQuestionId==collResponses[idx].QuestionId){switch(prop){case"Id":retPropValue=collResponses[idx].ReasonId;break;case"OtherText":retPropValue=collResponses[idx].ReasonDetails;break}}}}return retPropValue}function CanCheckResponseId(responseId,responseIdArr){var didResponseIdMatch=false;for(var idx=0;idx<responseIdArr.length;idx++){if(responseId==responseIdArr[idx]){didResponseIdMatch=true;break}}return didResponseIdMatch}function GetResponseControlType(responseControlTypeId){var responseControlType="";switch(responseControlTypeId){case 1:responseControlType="radio"break;case 2:responseControlType="checkbox"break;case 3:responseControlType="select"break;case 4:responseControlType="textbox"break;case 5:responseControlType="numerictextbox";break}return responseControlType}function GetResponseType(questionId){var retResponseType="";var questionsObj=JSON.parse(localStorage.getItem("questions"));var questions=questionsObj.Questions;for(var idx=0;idx<questions.length;idx++){if(questions[idx].ID==questionId){retResponseType=GetResponseControlType(questions[idx].ResponsesType);break}}return retResponseType}function CancelResponses(e){window.location.href="login.html"}var listViewResponseId="",userListViewResponseId="";function CollectResponse(e){try{var canSaveResponse=true;var responseType=GetResponseType(paramQuestionId);var responseId="";var isOther=false;var otherText="";var collResponses=JSON.parse(localStorage.getItem("CollectedResponses"));var response,otherCtl,indivResponseId;for(var idx=0;idx<collResponses.length;idx++){response=collResponses[idx];if(response.QuestionId==paramQuestionId){switch(responseType){case"radio":case"checkbox":$('input[name="input-'+paramQuestionId+'"]:checked').each(function(){indivResponseId=$(this).attr('id');responseId=responseId+indivResponseId+",";otherCtl=$('#'+indivResponseId+'.textbox-true:checked');isOther=otherCtl.attr('id')!=undefined;if(isOther){otherText=$('#'+indivResponseId+"-txtother").val()}});if(responseId!=""){responseId=responseId.substring(0,responseId.length-1)}break;case"select":responseId=$('input[name="input-'+paramQuestionId+'"]:checked').attr('id');if(responseId==undefined){if(listViewResponseId!=undefined&&listViewResponseId!=""){responseId=listViewResponseId}else if(userListViewResponseId!=undefined&&userListViewResponseId!=""){responseId=userListViewResponseId}listViewResponseId=""}otherText="";break}collResponses[idx].ReasonId=responseId;var otherReasonId="";if(otherText!=""&&otherText!=undefined){collResponses[idx].OtherReasonId=responseId;collResponses[idx].ReasonDetails=otherPrefix+otherText.replace(otherPrefix,"")}else{collResponses[idx].OtherReasonId=otherReasonId;collResponses[idx].ReasonDetails=""}break}}localStorage.setItem("CollectedResponses",JSON.stringify(collResponses));if(isOther){if($.trim(otherText)==''){$('div.OtherDiv input').addClass('Error').focus();canSaveResponse=false}}if(canSaveResponse){app1.navigate('#')}}catch(err){console.log('err occured..');console.log(err.message)}}function getOrganizations(){var question,responseForQuestion,questionText;if(eventQuestions==undefined){eventQuestions=JSON.parse(localStorage.getItem("questions"))}var allQuestions=eventQuestions.Questions;for(var idx=0;idx<allQuestions.length;idx++){question=allQuestions[idx];if(question.ID==paramQuestionId){responseForQuestion=question.Responses;questionText=question.QuestionText;break}}$('#spanQuestionText1').text(questionText);return responseForQuestion}